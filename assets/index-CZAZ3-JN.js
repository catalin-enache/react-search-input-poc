import{r as e,j as o}from"./index-DN5Qe1xR.js";const T=(n,r)=>{let s;return function(...u){return s&&clearTimeout(s),s=setTimeout(()=>{n(...u)},r),()=>{s&&(clearTimeout(s),s=null)}}},U=(n,r)=>{const s=e.useMemo(()=>T(n,r),[n,r]),u=e.useRef(null);return e.useEffect(()=>()=>{u.current&&u.current()},[]),e.useCallback((...h)=>{u.current=s(...h)},[s])},M=e.forwardRef(({items:n,onSelect:r,isVisible:s,formatter:u=t=>t},h)=>{const[t,l]=e.useState(null),f=e.useCallback(a=>{if(s)switch(a.key){case"ArrowDown":{a.preventDefault();const d=t?n.indexOf(t):-1,i=n[(d+1)%n.length];l(i),r(i);break}case"ArrowUp":{a.preventDefault();const d=t?n.indexOf(t):n.length,i=n[(d-1+n.length)%n.length];l(i),r(i);break}}},[r,t,n,s]);return e.useEffect(()=>(document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}),[f]),o.jsx("ul",{ref:h,className:`selectableList ${s?"selectableList--visible":""}`,children:n.map(a=>o.jsx("li",{onPointerDown:()=>{l(a),r(a)},className:`selectableList__item ${t===a?"selectableList__item--selected":""}`,children:u(a.value)},a.id))})}),H=e.memo(M),O=()=>{const n=e.useRef(!0);return e.useEffect(()=>{n.current=!1},[]),n.current},P=()=>{const n=e.useRef(!1);return e.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),n},B=(n,r)=>{const u=r.split(" ").map(t=>t.trim()).reduce((t,l)=>(t[l]=`<b>${l}</b>`,t),{});return`<span>${n.split(" ").map(t=>t.trim()).filter(Boolean).map(t=>u[t]||t).join(" ")}</span>`},K=n=>r=>{n.forEach(s=>{typeof s=="function"?s(r):s!=null&&(s.current=r)})},G=""+new URL("search-EyHvSUW4.svg",import.meta.url).href,W=300,Y=n=>r=>o.jsx("span",{dangerouslySetInnerHTML:{__html:B(r,n)}}),q=e.forwardRef(({label:n="Search",value:r,getHints:s,onChange:u},h)=>{const[t,l]=e.useState(""),[f,a]=e.useState(r),[d,i]=e.useState(t),C=U(i,W),[x,v]=e.useState(!1),[R,j]=e.useState([]),m=e.useRef(!1),I=e.useRef(t!==r),[V,D]=e.useState(!1),p=e.useRef(null),y=O(),N=P(),g=K([h,p]);I.current=t!==r,e.useEffect(()=>{d!==t&&C(t)},[C,t,d]);const b=e.useCallback(c=>{a(c),l(c),i(c)},[]);e.useEffect(()=>{b(f),u==null||u(f)},[u,f,b]);const E=e.useCallback(c=>{D(!0),s==null||s(c.trim()).then(w=>{N.current&&(j(w.map($=>({id:$,value:$}))),D(!1))}),m.current=!1},[s,N]);e.useEffect(()=>{m.current&&E(d)},[j,s,d,E]);const A=e.useCallback(c=>{m.current=!0,v(!0),l(c.target.value)},[]);e.useEffect(()=>{I.current&&(m.current=y,l(r))},[r,y]);const L=e.useCallback(c=>{c.target!==p.current&&document.activeElement!==p.current&&v(!1)},[]),k=e.useCallback(c=>{v(c.target===p.current),m.current=c.target!==p.current,m.current&&(b(t),E(t))},[t,b,E]);e.useEffect(()=>(document.addEventListener("pointerdown",k),()=>{document.removeEventListener("pointerdown",k)}),[k]),e.useEffect(()=>(document.addEventListener("pointerup",L),()=>{document.removeEventListener("pointerup",L)}),[L]);const S=e.useCallback(c=>{c.key==="Enter"&&(m.current=!0,b(t),E(t),p.current===document.activeElement&&v(x?!t:!0))},[b,t,x,E]);e.useEffect(()=>(document.addEventListener("keydown",S),()=>{document.removeEventListener("keydown",S)}),[S]);const F=e.useCallback(c=>{l(c.value),i(c.value),setTimeout(()=>{var w;(w=p.current)==null||w.focus()})},[]),_=R.length>0&&x;return o.jsxs("div",{className:"autoComplete",children:[o.jsx("div",{children:o.jsxs("label",{children:[n," ",V&&"...",o.jsxs("span",{className:"autoComplete__inputContainer",children:[o.jsx("input",{ref:g,className:`autoComplete__input ${_?"autoComplete__input--withHints":""}`,type:"search",value:t,onChange:A,placeholder:"Search..."}),o.jsx("span",{className:"autoComplete__inputIcon",children:o.jsx("svg",{children:o.jsx("use",{href:`${G}#icon`})})})]})]})}),o.jsx("div",{className:`autoComplete__hints ${_?"autoComplete__hints--visible":""}`,children:o.jsx(H,{formatter:Y(t),items:R,isVisible:_,onSelect:F})})]})}),J=q;export{J as default};
//# sourceMappingURL=index-CZAZ3-JN.js.map
