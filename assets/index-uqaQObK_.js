import{r as e,j as o}from"./index-BuCjpt2p.js";const M=(n,r)=>{let s;return function(...u){return s&&clearTimeout(s),s=setTimeout(()=>{n(...u)},r),()=>{s&&(clearTimeout(s),s=null)}}},T=(n,r)=>{const s=e.useMemo(()=>M(n,r),[n,r]),u=e.useRef(null);return e.useEffect(()=>()=>{u.current&&u.current()},[]),e.useCallback((...h)=>{u.current=s(...h)},[s])},U=e.forwardRef(({items:n,onSelect:r,isVisible:s,formatter:u=t=>t},h)=>{const[t,l]=e.useState(null),f=e.useCallback(a=>{if(s)switch(a.key){case"ArrowDown":{a.preventDefault();const d=t?n.indexOf(t):-1,i=n[(d+1)%n.length];l(i),r(i);break}case"ArrowUp":{a.preventDefault();const d=t?n.indexOf(t):n.length,i=n[(d-1+n.length)%n.length];l(i),r(i);break}}},[r,t,n,s]);return e.useEffect(()=>(document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}),[f]),o.jsx("ul",{ref:h,className:`selectableList ${s?"selectableList--visible":""}`,children:n.map(a=>o.jsx("li",{onPointerDown:()=>{l(a),r(a)},className:`selectableList__item ${t===a?"selectableList__item--selected":""}`,children:u(a.value)},a.id))})}),B=e.memo(U),H=()=>{const n=e.useRef(!0);return e.useEffect(()=>{n.current=!1},[]),n.current},O=()=>{const n=e.useRef(!1);return e.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),n},P=(n,r)=>{const u=r.split(" ").map(t=>t.trim()).reduce((t,l)=>(t[l]=`<b>${l}</b>`,t),{});return`<span>${n.split(" ").map(t=>t.trim()).filter(Boolean).map(t=>u[t]||t).join(" ")}</span>`},z=n=>r=>{n.forEach(s=>{typeof s=="function"?s(r):s!=null&&(s.current=r)})},K="data:image/svg+xml,%3csvg%20id='icon'%20focusable='false'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20%3e%3cpath%20stroke='none'%20fill='currentColor'%20d='M15.5%2014h-.79l-.28-.27A6.471%206.471%200%200%200%2016%209.5%206.5%206.5%200%201%200%209.5%2016c1.61%200%203.09-.59%204.23-1.57l.27.28v.79l5%204.99L20.49%2019l-4.99-5zm-6%200C7.01%2014%205%2011.99%205%209.5S7.01%205%209.5%205%2014%207.01%2014%209.5%2011.99%2014%209.5%2014z'%20/%3e%3c/svg%3e",G=300,Y=n=>r=>o.jsx("span",{dangerouslySetInnerHTML:{__html:P(r,n)}}),q=e.forwardRef(({label:n="Search",value:r,getHints:s,onChange:u},h)=>{const[t,l]=e.useState(""),[f,a]=e.useState(r),[d,i]=e.useState(t),_=T(i,G),[x,E]=e.useState(!1),[j,R]=e.useState([]),m=e.useRef(!1),I=e.useRef(t!==r),[$,D]=e.useState(!1),p=e.useRef(null),g=H(),y=O(),V=z([h,p]);I.current=t!==r,e.useEffect(()=>{d!==t&&_(t)},[_,t,d]);const b=e.useCallback(c=>{a(c),l(c),i(c)},[]);e.useEffect(()=>{b(f),u==null||u(f)},[u,f,b]);const v=e.useCallback(c=>{D(!0),s==null||s(c.trim()).then(w=>{y.current&&(R(w.map(N=>({id:N,value:N}))),D(!1))}),m.current=!1},[s,y]);e.useEffect(()=>{m.current&&v(d)},[R,s,d,v]);const A=e.useCallback(c=>{m.current=!0,E(!0),l(c.target.value)},[]);e.useEffect(()=>{I.current&&(m.current=g,l(r))},[r,g]);const k=e.useCallback(c=>{c.target!==p.current&&document.activeElement!==p.current&&E(!1)},[]),L=e.useCallback(c=>{E(c.target===p.current),m.current=c.target!==p.current,m.current&&(b(t),v(t))},[t,b,v]);e.useEffect(()=>(document.addEventListener("pointerdown",L),()=>{document.removeEventListener("pointerdown",L)}),[L]),e.useEffect(()=>(document.addEventListener("pointerup",k),()=>{document.removeEventListener("pointerup",k)}),[k]);const C=e.useCallback(c=>{c.key==="Enter"&&(m.current=!0,b(t),v(t),p.current===document.activeElement&&E(x?!t:!0))},[b,t,x,v]);e.useEffect(()=>(document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C)}),[C]);const F=e.useCallback(c=>{l(c.value),i(c.value),setTimeout(()=>{var w;(w=p.current)==null||w.focus()})},[]),S=j.length>0&&x;return o.jsxs("div",{className:"autoComplete",children:[o.jsx("div",{children:o.jsxs("label",{children:[n," ",$&&"...",o.jsxs("span",{className:"autoComplete__inputContainer",children:[o.jsx("input",{ref:V,className:`autoComplete__input ${S?"autoComplete__input--withHints":""}`,type:"search",value:t,onChange:A,placeholder:"Search..."}),o.jsx("span",{className:"autoComplete__inputIcon",children:o.jsx("svg",{children:o.jsx("use",{href:`${K}#icon`})})})]})]})}),o.jsx("div",{className:`autoComplete__hints ${S?"autoComplete__hints--visible":""}`,children:o.jsx(B,{formatter:Y(t),items:j,isVisible:S,onSelect:F})})]})}),Q=q;export{Q as default};
//# sourceMappingURL=index-uqaQObK_.js.map
